
%%%%%%%%%%
% Préambule
\input{preambule/preambule.tex}

%%%%%%%%%%
% Titre et auteur
\title{Un modèle de thèse \LaTeX{} en français utilisant entre autres Sweave, Bib\LaTeX{}, Glossary et Ti\textit{k}Z}
\author{Marie Lemarié-Boutry}

%%%%%%%%%%
% Chargement des résultats

%%%%%%%%%%
% Contenu
\usepackage{Sweave}
\begin{document}

% Frontmatter
\frontmatter
% Page de garde
\includepdf{build/pagegarde.pdf}% fichier pagegarde.tex à compiler au préalable simplement avec pdf latex 

\setcounter{page}{1}
\cleardoublepage
\input{front/front.tex}

% Corps du document
\mainmatter
\cleardoublepage
\pagestyle{scrheadings} 

\phantomsection
\addcontentsline{toc}{chapter}{Introduction générale}
\chapter*{Introduction générale \label{chap:intro}}\markboth{Introduction générale}{Introduction générale}
%!TEX encoding = utf8

Je partage ici le \etran{template} qui a servi à la rédaction de mon manuscrit de thèse. Ce document est avant tout une sorte de patron à la rédaction d'un document long. Ce n'est pas un ouvrage dédié à \LaTeX{} même si je rappelle dans le corps du texte quelques commandes qui m'ont été très utiles. 

\begin{figure}
\renewcommand{\thefigure}{I.\arabic{figure}}
\includegraphics[width=\textwidth]{pictures/fig_intro.png}
\caption[Titre alpha court de la figure]{Titre alpha long de la figure -- avec un commentaire (source: \citetalias{DBGEOFLA})}\label{fig:intro}
\end{figure}

\section*{Classe de document et packages}

J'uilise ici la classe de document \verb!scrbook! de \verb!KOMA-script!. Pour en savoir plus, allez lire le document suivant très complet \url{https://framabook.org/docs/komascript/KOMAScript_Framaboook_LPPL.pdf}. Les packages \emph{principaux} qui sous-tendent ce document sont \verb!sweave!, \verb!siunitx!, \verb!tikz!, \verb!glossary!, \verb!biblatex! associé à \verb!natbib!, et \verb!hyperref!. L'ensemble des packages et éléments de configuration sont rassemblés dans le dossier \verb!preambule!. Pour connaitre la liste exhaustive des packages appelés, vous pouvez consulter le fichier \verb!build/these_docprincipal.log!. Notez que certains packages sont spécifiques à \verb!KOMA-script!. 

\section*{Au sujet des métadonnées}

Notez que le package \verb!hyperref! permet de spécifier les métadonnées du fichier (auteur, nom du fichier, sujet, mots-clés). N'oubliez pas de modifier ces dernières dans les fichiers \verb!pagedegarde.tex! et \verb!preambule/PDF_related.tex!. 

\section*{Autre titre non numéroté de l'introduction}

Pour obtenir une introduction suffisamment longue et ainsi avoir une idée de la mise en page, introduisons dorénavant un peu de \latin{lipsum}.

\lipsum[3-4]

\chapter[Dans le texte]{\Longstack[l]{Dans le texte: citations, références, \\ acronymes et glossaire}  \label{chap:1}}% 
%!TEX encoding = utf8
\glsresetall % réinitialisation des acronymes

\section[Titre court de la section 1]{Un exemple de titre long de la section 1 du chapitre 1}\label{sec:11}

\subsection{Sous-section 1 de la section 1}

Enumerer:
\begin{enumerate}
\item objet;
\item objet;
\item objet.
\end{enumerate}

Lister:
\begin{itemize}
\item objet;
\item objet;
\item objet.
\end{itemize}

\subsubsection{Sous-sous-section 1 de la section 1}

\paragraph{Paragraph}

\paragraph{Paragraph}

\subsubsection{Sous-sous-section 2 de la section 1}

\subsection{Sous-section 2}

\section[Des commandes dans le corps du texte]{Des commandes à garder en tête lors de l'écriture qui faciliteront grandement la mise en forme finale.
}\label{sec:12}

\subsection{Citations avec natbib et extraits}

J'utilise ici le package \verb!natbib! et les commandes \verb!\citet! pour citer au format "Auteur (Année)" tel que \citet{Anselin1990}, \verb!\citep! pour citer au format "(Auteur, Année)" tel que \citep{Holloway2007}, ou \verb! \citep[p.~12]!  pour citer un auteur et une page associée tel que \citep[p.~12]{Margeon2009}. 

J'ai particulièrement personnalisé le formatage de ma bibliographie : allz voir le fichier  \verb!preambule/biblio.tex! ainsi que les fichiers \verb!macros/bibdriver_*.tex!. 
Cela me permet de citer des livres \citep{Margeon2009,Boulay2013}, des articles de revues scientifiques  \citep{Anselin1990,Holloway2007}, des rapports institutionnels \citep{Pomel2006,Roumegoux2008}, des articles de journaux \citep{AQUI20170405,LAVIGNE20130531}, des textes juridiques \citepalias{LOI200611,DECRETLOI19350730} ou encore des bases de données \citep{DBGEOFLA,DBINSEERGP} selon mes besoins.

Notez que pour citer un extrait, on a recours parfois aux ellipses, \LaTeX{} a prévu une commande à cette fin \verb!\textellipsis! : "blablabla [\textellipsis] blablabla".

\subsection{Renvois et notes de bas de page}

Utiliser des renvois en notes de bas de page \footnote{Une note de bas de page}. Indiquer un lien vers un site \url{https://www.latex-project.org/} avec la commande \verb!\url!.

Faire référence: à des figures (figure \ref{fig:exemple}), à des pages  (voir figure \ref{fig:tikztemps} en page \pageref{fig:tikztemps}), à des tableaux (tableau \ref{tab:tabresumecourt}), à des sections (section \ref{sec:11}). 

\subsection{Acronymes avec Glossary}

Utiliser un acronyme une première fois dans le chapitre : \gls{SIG}. Utiliser une seconde fois ce même acronyme dans ce chapitre: \gls{SIG}. Utiliser cet acronyme au pluriel: \glspl{SIG}. Utiliser d'autres acronymes : \gls{GIS}, \gls{SEM}, \gls{IGN}, \gls{INSEE} qui seront ensuite repris dans la \hyperref[list:acro]{liste des acronymes} en fin de document. Certains acronymes sont associés à une définition, qui est reportée dans le \hyperref[list:gloss]{glossaire} également en fin de document.  

\subsection{Ponctuations, emphases et mots étrangers}

Ecrire des points de suspension\dots avec \verb!\dots!, renvoyer au 20\ieme siècle avec \verb!\ieme!, mettre en \emph{emphase} avec \verb!\emph!. J'ai ajouter des commandes personnelles telles que \verb!\latin! pour les locutions latines \latin{etc.} et \verb!\etran! pour les mots étrangers \etran{Hello !}
\chapter[Un peu de maths]{\Longstack[l]{Un peu de maths: nombres, \\ unités, sweave, équations \\ et tableaux} \label{chap:3}}%
%!TEX encoding = utf8
\glsresetall

Pour toute la partie mathématique, j'invite le lecteur à explorer le fichier \verb!preambule/mathematiques.tex!.

\section{Des commandes pour une mise en forme mathématique automatique}\label{sec:31}

A l'instar du chapitre \ref{chap:1}, il peut être intéressant de définir des commandes de mise en forme automatique. J'ai fait le choix par exemple de créer les commandes personnelles. Pour citer des variables dans le corps de texte, j'utilise \verb!\var!qui formate automatiquement les noms de variables: par exemple,  \var{Sepal.Length}, \var{Species}. Les commandes \verb!\na!, \verb!\nodata! et \verb!\secret! permettent de leur côté de formater des valeurs soit manquantes (l'équivalent du NA), soit inexistantes (l'équivalent du NULL), soit tues pour des raisons de secret statistique. 

Pour formater automatiquement des nombres ou des unités dans le texte (ici normes françaises), on  utilise le package \verb!siunitx!:  \SI{10000}{\hectare} (commande \verb!\SI!), \num{24.14} (commande \verb!\num! pour un nombre sans unité), \si{\km\per\second} (commande  \verb!\si! pour des unités sans valeur associée).

\section{Des équations}\label{sec:32}

Pour introduire du langage mathématique dans le corps de texte, on l'encastre entre \verb!$! et \verb!$!. Par exemple, \verb!$\delta_{p}+\rho_{p}$! donne l'expression $\delta_{p}+\rho_{p}$.

S'agissant des équations, voici un exemple de mise en forme d'une équation sur plusieurs lignes: 

\noindent\begin{minipage}{0.53\linewidth} 
\begin{equation}\label{eq:long}
\begin{split}
\ln{Y}= \alpha&+\sum_{k}(\tau_{k}.T_{k})\\
&+\sum_{i}(x_{i}.X_{i})\\
&+\varepsilon
\end{split}
\end{equation}
\end{minipage}
\hfill
\begin{minipage}{0.38\linewidth} 
{\footnotesize
Avec un commentaire sur la signification des variables par exemple : $Y$ variable à expliquer, $X$ et $T$ variables explicatives, $\tau$ et $x$ des paramètres.
}
\end{minipage}

\section{Un peu de Sweave}\label{sec:33}

Pour indiquer dans le texte une valeur calculée automatiquement et simultanément \latin{via} \R{}, on peut utiliser la commande \verb!\Sexpr!. Le nombre d'observations de la table \verb!iris! du package \verb!datasets! de R se calcule par exemple avec la commande \verb!\!\verb!Sexpr{dim(iris)[1]}!  : ce qui donne un résulat de \num{150} observations. Pour aller plus loin, on peut consulter, par exemple, le document \url{https://pbil.univ-lyon1.fr/R/pdf/tdr78.pdf}.

Vous aurez remarqué que dans ce document j'introduis parfois du code source, j'utilise pour cela la commande \verb!\verb!. L'environnement \verb!verbatim! fonctionne également très bien. 
\chapter[Flottants]{\Longstack[l]{Flottants:  encadrés, images, \\  TikZ et  tableaux} \label{chap:2}}%
%!TEX encoding = utf8
\glsresetall

Dans ce chapitre, j'ai inséré des "flottants" à savoir des encadrés courts et longs, une figure, du Ti\textit{k}Z ainsi que des tableaux. Les packages et commandes ont été déclarés dans les fichiers \verb!preambule/floating.tex! et \verb!preambule/dessin.tex!.

Par défaut, les figures sont insérées sur une pleine page (fichier: \verb!preambule/floating.tex!). 
Dans la légende de la figure \ref{fig:exemple}, j'utilise la commande personnelle \verb!\citetalias! pour citer simplement une base de données. Parfois, on peut avoir besoin d'introduire une figure sur plusieurs pages (voir figure \ref{fig:exemplelong}). On utilise alors la commande \verb!\ContinuedFloat! du package \verb!subfig!. 

J'ai inséré des figures réalisées en Ti\textit{k}Z qui m'avaient particulièrement marquées et que je m'étais réappropriées pour ma thèse. Ces figures ont été réalisées grâce à des partages de scripts de la communauté (voir fichiers du dossier \verb!tikz/!).

Enfin, j'ai inclus des tableaux (tableaux \ref{tab:tabdico} et \ref{tab:tabresumecourt}). Dans la mesure où on peut introduire un grand nombre de variables dans l'analyse, le tableau \ref{tab:tabdico} est par défaut un \verb!longtable!, ce qui lui permet de s'étendre sur plusieurs pages le cas échéant. Mais de petits tableaux tels que le tableau \ref{tab:tabresumecourt} peuvent également être plus simplement utilisés.

\section[Des encadrés]{Une section où sont insérés des encadrés courts et longs}\label{sec:21}

\lipsum[4]

\begin{frameenv}{Un encadré court}{Un encadré court}\label{enc:court}
\input{encadres/enc_court}
\end{frameenv}

\lipsum[5]

\lipsum[6]

\lipsum[7]

\begin{frameenv}{Un encadré long}{Un encadré long}\label{enc:long}
\input{encadres/enc_long}
\end{frameenv}
\begin{frameenv*}{}{Un encadré long (suite)}\label{enc:long2}
\input{encadres/enc_long2}
\end{frameenv*}

\lipsum[8]

\lipsum[9]

\section[Des figures]{Une section où sont insérés des figures}\label{sec:22}

\begin{figure}
\includegraphics[width=\textwidth]{pictures/fig_exemple.png}
\caption[Titre court de la figure]{Titre long de la figure (données: \citetalias{DBINSEERGP,DBGEOFLA}; calculs et représentation graphique: l'auteur)}\label{fig:exemple}
\end{figure}

\lipsum[10]

\lipsum[11]

\lipsum[12]

\lipsum[13]

\lipsum[14]

\lipsum[15]

\begin{figure}[p]
\fbox{%
\includegraphics[page=1,width=0.95\textwidth]{pictures/fig_exemplelong1.png}}
\caption{Une illustration sur plusieurs pages}
\label{fig:exemplelong}
\end{figure}
\begin{figure}[p]
\ContinuedFloat % Suite
\captionsetup{list=no} % Non mentionné dans la liste des figures
\fbox{%
\includegraphics[page=2,width=0.95\textwidth]{pictures/fig_exemplelong2.png}}
\caption{Une illustration sur plusieurs pages (suite)}
\end{figure}

\lipsum[16]

\lipsum[17]

\lipsum[18]

\lipsum[19]

\section[Un peu de TikZ]{Une section où sont insérés des exemples de figures réalisées en TikZ}\label{sec:23}

\lipsum[18]

\lipsum[19]

\begin{figure}
\centering
\input{tikz/tikztensions.tex}
\caption[Schéma TikZ: tensions]{Schéma TikZ: diagramme tensions (source: \url{https://github.com/mlemarieb/these-mlb/blob/master/tikz/tikztensions.tex})}\label{fig:tikztensions}
\end{figure}

\lipsum[20]

\lipsum[21]

\begin{figure}
\input{tikz/tikztemps.tex}
\caption[Schéma TikZ: chronologie]{Schéma TikZ: chronologie (source: \url{https://olivierlemaire.wordpress.com/2010/12/21/frise-chronologique/} (site initial supprimé par son auteur)) 
\comment{Un commentaire sur la figure.}}\label{fig:tikztemps}
\end{figure}

\begin{figure}
\input{tikz/tikzsources.tex}
\caption[Schéma TikZ: multi-échelles]{Schéma TikZ: multi-échelles (source: \url{http://www.texample.net/tikz/examples/swan-wave-model/
})}\label{fig:tikzsources}
\end{figure}

\lipsum[22]

\lipsum[23]

\section[Des tableaux ]{Des tableaux}\label{sec:24}

\lipsum[24]

\input{sorties/tabresumecourt.tex}

\lipsum[25]

\input{sorties/tabdico.tex}

\cleardoublepage 
\phantomsection
\addcontentsline{toc}{chapter}{Conclusion générale}
\chapter*{Conclusion générale \label{chap:conclu}}\markboth{Conclusion générale}{Conclusion générale}
\lipsum[5-6]

% Appendix
\appendix
\cleardoublepage 
\input{appendix/app.tex}

% Backmatter
\backmatter
\cleardoublepage 
\pagestyle{scrheadings} 
\input{back/back.tex}

\end{document}
